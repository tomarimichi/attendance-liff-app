<!DOCTYPE html>
<html lang="ja">
<head>
  <!--テスト用　後で消す-->
    <meta name="last-updated" content="2026/02/27 12:01">

  <meta charset="utf-8">

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <title>欠席・遅刻連絡</title>
  <link rel="stylesheet" href="css/style.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


</head>

<body>
  <div class="dev-only">
    <h1>DV VERSION</h1>
    <p>🎨 UI開発モード</p>
    <!--テスト用　  後で消す-->
      <div class="test">
        <h1>テスト環境</h1>
        <p id="update-time">更新時間・読み込み中...</p>
      </div>
      <script>
        // GitHub Pages最終更新日自動取得
        document.addEventListener('DOMContentLoaded', function() {
          const updateTime = document.getElementById('update-time');
          if (updateTime) {
            // GitHub Pagesのメタタグから最終更新取得
            const meta = document.querySelector('meta[name="last-updated"]');
            if (meta && meta.content) {
              updateTime.textContent = `最終更新・${meta.content}`;
            } else {
              // フォールバック：ビルド日時（手動更新不要）
              const now = new Date(Date.UTC(2026, 0, 9, 11, 10)); // JST+9考慮
              updateTime.textContent = `最終更新・${now.toLocaleString('ja-JP', {timeZone: 'Asia/Tokyo'})}`;
            }
          }
        });
      </script>
  </div>
  <!-- ローディング表示 -->
    <div class="">
      <div id="loading-overlay" class="loading-overlay">
        <div class="loading-box">
          <div class="spinner"></div>
          <p id="loading-text">入力画面を準備しています…</p>
        </div>
      </div>
      <!-- エラー表示 -->
      <div id="error" style="display:none; color:red;">
        <p>
          データの取得に失敗しました。<br>
          時間をおいて再度お試しください。
        </p>
      </div>
    </div>

    
  <main class="container">


    <h3>欠席・遅刻連絡フォーム</h3>


    <div class="main-Fields">
      <form id="absenceForm">
        <!-- 入力エリア -->
        <div id="formFields">
          <!-- 欠席・遅刻日 -->
          <div class="form-field">
            <label for="absentDate" class="required">欠席・遅刻日</label>
            <input type="date" id="absentDate" name="absentDate" required>
          </div>

          <!-- 欠席・遅刻理由 -->
          <div class="form-field">
            <label for="reason" class="required">欠席・遅刻理由</label>
            <select id="reason" name="reason" required>
            </select>
          </div>


          <!-- 理由詳細 -->
          <div class="form-field">
            <div id="detailBlock" style="display:none;">
              <label for="detail" class="required">詳細</label>
              <select id="detail" name="detail"></select>
            </div>
          </div>

          <!-- 症状 -->
          <div class="form-field">
            <div id="symptomBlock" style="display:none;">
              <label for="symptom" class="required">症状（複数選択可）</label>
              <select id="symptom" name="symptom" multiple>
              </select>
            </div>
          </div>

          <!-- 症状その他 自由記入 -->
            <div id="symptomOtherArea" class="form-field" style="display:none;">
              <label for="symptomOther">その他 自由記入</label>
              <textarea
                id="symptomOtherText"
                placeholder="症状を具体的に記入してください"
              ></textarea>
            </div>

          <!-- 通院有無 -->
          <div class="form-field">
            <div id="visitStatusBlock" style="display: none;">
              <label for="visitStatus" class="required">通院有無・予定</label>
              <select id="visitStatus" name="visitStatus">
                <option value="">選択してください</option>
                <option value="NONE">予定なし</option>
                <option value="PLAN">受診予定あり</option>
                <option value="DONE">受診済み</option>
              </select>
            </div>
          </div>

          <!-- 受診科 -->
          <div class="form-field">
            <div id="departmentBlock" style="display: none;">
              <label for="department" class="required">受診科（複数選択可）</label>
              <select id="department" name="department" multiple>
              </select>
            </div>
          </div>

          <!-- 受診科その他 自由記入 -->
            <div id="departmentOtherArea" class="form-field" style="display:none;">
              <label for="departmentOther">その他 自由記入</label>
              <textarea
                id="departmentOtherText"
                placeholder=""
              ></textarea>
            </div>


          <div class="form-field">
            <label for="nextDate" class="required">次回通所予定日</label>
            <input type="date" id="nextDate" name="nextDate" class="absentDate-input" required>
          </div>

          <div class="form-field">
            <label for="nextTime">遅刻予定（時刻が分かる場合）</label>
            <input type="time" id="nextTime" name="nextTime" class="time-input">
          </div>

          <!-- 隠しフィールド -->
          <div class="HiddenDiv">
            <input type="hidden" id="lineUserId" name="lineUserId">
            <input type="hidden" id="displayName" name="displayName">

            <input type="hidden" id="liffVersion" name="liffVersion">
          </div>
        </div>

        <!-- 送信ボタン -->
        <button type="submit" id="sendBtn">>
          送信する
        </button>

        <!-- ステータス表示エリア -->
        <div id="statusArea" class="status hidden">
          <div class="status-icon"></div>
          <div class="status-title"></div>
          <div class="status-message"></div>
          <div class="status-actions"></div>
        </div>        
      </form>
    </div>


    





  </main>



  <script src="js/config_dev.js"></script>
  <script src="js/utility.js"></script>
  <script src="js/dom.js"></script>
  <script src="js/master.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/submit.js"></script>
  <script src="js/app.js"></script>

</body>
</html>
